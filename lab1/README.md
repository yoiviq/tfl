# Лабораторная работа №1
## Задание:  
По имеющейся **SRS** определить: 
- завершимость
- конечность классов эквивалентности по НФ (для построения эквивалентностей считаем, что правила могут применяться в обе стороны). Если их конечное число, то построить минимальную систему переписывания, им соответствующую.
- локальную конфлюэнтность и пополняемость по Кнуту-Бендиксу  

### 1. Докажем завершимость
Система переписывания:
* $\texttt{bpb} \to \texttt{abapba}$
* $\texttt{p} \to \texttt{aba}$
* $\texttt{apa} \to \texttt{bb}$
* $\texttt{abba} \to \texttt{baab}$

#### Рассмотрим отображение $F_1: \Sigma^* \to \mathbb{N}$ 

$$
F_1(w) := |w|_p
$$

(количество вхождений символа $p$ в слово $w$)

$F_1$ строго убывает при применении правил $\texttt{p} \to \texttt{aba}$ и $\texttt{apa} \to \texttt{bb}$, однако оставшиеся два правила из системы оставляют значение $F_1$ неизменным. 

Значит, для определения фундированного порядка необходимо ввести лексикографический порядок над $\Sigma^*$. 

#### Рассмотрим отображение  $F_2: \Sigma^* \to \mathbb{N}$ 

$$
F_2(w) := \sum_{i=0}^{|w|-1} f(w[i])2^{|w|-i-1}
$$

(воспринимаем любое слово в виде двоичного числа, а после переводим его в десятичную систему).

$F_2$ строго убывает при применении правила $\texttt{abba} \to \texttt{baab}$, в то время как $F_1$ и $F_2$ не меняют своего значения. 

Таким образом, определяем лексикографический порядок через отображение $F: \Sigma^* \to \mathbb{N}^3$ 

$$
F(w) := (F_1, F_2)
$$

Изначально рассматриваем количество вхождений символа $p$, далее рассматриваем вес слова в двоичной системе. 

Остается одно проблемное правило, не убывающее по введенному порядку: $\texttt{bpb} \to \texttt{abapba}$. Почему оно не может создать бесконечную цепочку переписываний? 

После применения этого правила, вокруг буквы $p$ образуется подстрока $apb$, окруженная подсловами $ab$ и $ba$. Единственное возможное для применения правило в такой ситуации - это $\texttt{p} \to \texttt{aba}$. Получаем подстроку $abaababa$, которая не содержит потенциально бесконечного цикла. 

Перейдем к рассмотрению краевых случаев при применении данного правила. Бесконечный цикл может быть получен только при пересечении с правилом $\texttt{abba} \to \texttt{baab}$, однако это правило не меняет длину слова, то есть подстрока $abba$ просто "мигрирует" по слову, пока цепочка переписываний не сойдется к одному из двух случаев: 

1. Миграция происходила с конца в начало: $ba(ab)^n$
2. Наоборот: $(ba)^nab$

Таким образом, ***система завершима***, так как в ней невозможно построить бесконечых циклов переписывания.

### 2. Классы эквивалентности по НФ

Число нормальных форм **бесконечно**: к примеру, каждое слово из $a^n$, $b^n$ при $n >= 1$ будет давать бесконечное число различных нормальных форм. 

### 3. Локальная конфлюэнтность

Рассмотрим слово $w = bpb$, содержащее в себе критическую пару. 

```mermaid
graph TD
bpb-->abapba
abapba-->abaababa
bpb-->babab
```
$w \to v_1, v_1 = babab$ при применении правила $\texttt{p} \to \texttt{aba}$
$w \to v_2, v_2 = abaababa$ при применении правила $\texttt{bpb} \to \texttt{abapba}$. 

**Локальной конфлюэнтности нет**, так как $v_1$ и $v_2$ являются нормальными формами (не содержат редексов).

### 4. Пополняемость по Кнуту-Бендиксу
По алгоритму Кнута-Бендикса, добавляем правило по критической паре из правил $\texttt{p} \to \texttt{aba}$ и $\texttt{apa} \to \texttt{bb}$:

* $\texttt{aabaa} \to \texttt{bb}$

Оно формирует критическую пару с правилом  $\texttt{abba} \to \texttt{baab}$. Поэтому добавляем:

* $\texttt{baababaa} \to \texttt{abbbb}$

Оно формирует критическую правилу с правилом $\texttt{abba} \to \texttt{baab}$:

```mermaid
graph TD
abbaababaa-->baabababaa
abbaababaa-->ababbbb
```
Новое правило, извлеченное из этой крит. пары, будет также формировать крит. пару с правилом $\texttt{abba} \to \texttt{baab}$. Таким образом, алгоримт Кнута-Бендикса будет бесконечно добавлять правила вида:

$$
baa(ba)^{n+1}baa \to (ab)^nabbbb
$$

Следовательно, процедура пополнения не завершится конечным числом правил, и система **непополянема по алгоритму Кнута-Бендикса**. 

### 5. Инварианты

1. Количество букв $p$ (монотонно)
2. Количество букв $b$ (монотонно)
3. $(|a| + |b|)mod 3$
